name: "SERVUS US Onboarding (Okta Master Mode)"
description: "Wait for Okta (from Rippling) -> Customize Downstream"
steps:
  # 1. Validation
  - id: validate
    description: "Validate profile data"
    type: action
    action: builtin.validate_profile

  # 2. AD Wait (Passive Check)
  - id: ad_wait
    description: "AD: Check if user exists (synced from Okta)"
    type: action
    action: ad.validate_user_exists

  # 3. Google Wait
  - id: google_wait
    description: "Google: Wait for SCIM to create user"
    type: action
    action: google_gam.wait_for_user_scim

  # 4. Google Customize (OU Move)
  - id: google_move_ou
    description: "Google: Move to correct OU"
    type: action
    action: google_gam.move_user_ou

  # 5. Google Groups
  - id: google_groups
    description: "Google: Add to groups"
    type: action
    action: google_gam.add_groups

  # 6. Slack Customize
  - id: slack_customize
    description: "Slack: Add to channels"
    type: action
    action: slack.add_to_channels

  # 7. Device Check (Apple)
  - id: check_device
    description: "Apple: Check device assignment in ABM"
    type: action
    action: apple.check_device_assignment

  # 8. Physical Access (Brivo)
  - id: physical_access
    description: "Brivo: Create badge profile"
    type: action
    action: brivo.provision_access
