name: "SERVUS US Onboarding v1"
description: "Standard US employee/contractor onboarding flow (AD -> Okta -> Apps)"

steps:
  # --- PRE-FLIGHT ---
  - name: validate_profile
    description: "Validate profile fields (avoid typos/empty shells)"
    type: action
    action: builtin.validate_profile
    verify: auto

  # --- IDENTITY CORE (AD) ---
  - name: ad_provision
    description: "AD: create/reactivate + move to OU"
    type: action
    action: ad.provision_user
    verify: auto

  # --- IDENTITY SYNC (OKTA) ---
  - name: okta_trigger_import
    description: "Okta: trigger AD incremental import"
    type: action
    action: okta.trigger_ad_import
    verify: manual 

  - name: okta_find_user
    description: "Okta: wait for user to appear"
    type: action
    action: okta.find_user
    verify: auto

  - name: okta_assign_apps
    description: "Okta: assign core apps (Google/Slack; +Zoom/Ramp for FTE)"
    type: action
    action: okta.assign_apps
    verify: auto

  # --- GOOGLE WORKSPACE (AUTOMATED) ---
  - name: google_move_ou
    description: "Google: Move User to Proper OU (FTE/Contractor)"
    type: action
    action: google_gam.move_user_ou
    verify: auto

  - name: google_groups
    description: "Google: Add to Team/Contractor Groups"
    type: action
    action: google_gam.add_to_groups
    verify: auto

  # --- SLACK (AUTOMATED) ---
  - name: slack_channels
    description: "Slack: Add to Global & Dept Channels"
    type: action
    action: slack.add_to_channels
    verify: auto

  # --- MANUAL / PHYSICAL ---
  - name: hw_procure
    description: "Hardware procured / received"
    type: manual

  - name: badge_print
    description: "Badge printed"
    type: manual
